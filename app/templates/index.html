{% extends "layout.html" %}
{% block title %}PDF Annotator - 업로드{% endblock %}
{% block content %}
<form class="card" action="{{ url_for('main.annotate') }}" method="post" enctype="multipart/form-data">
  <h2>파일 업로드 & 옵션</h2>

  <div class="grid-2">
    <div>
      <label>엑셀 파일 (.xlsx / .xls)</label>
      <input type="file" name="excel_file" accept=".xlsx,.xls" required />
    </div>
    <div>
      <label>PDF 파일 (.pdf)</label>
      <input type="file" name="pdf_file" accept=".pdf" required />
    </div>
  </div>

  <h3>색상 선택 (컬럼별)</h3>
  <div class="grid-4">
    <div class="color-row">
      <label>A</label>
      <input type="color" name="color_A" value="{{ defaults['A'] }}">
      <span class="hex">{{ defaults['A'] }}</span>
    </div>
    <div class="color-row">
      <label>B</label>
      <input type="color" name="color_B" value="{{ defaults['B'] }}">
      <span class="hex">{{ defaults['B'] }}</span>
    </div>
    <div class="color-row">
      <label>C</label>
      <input type="color" name="color_C" value="{{ defaults['C'] }}">
      <span class="hex">{{ defaults['C'] }}</span>
    </div>
    <div class="color-row">
      <label>D</label>
      <input type="color" name="color_D" value="{{ defaults['D'] }}">
      <span class="hex">{{ defaults['D'] }}</span>
    </div>
  </div>

  <h3>불투명도</h3>
  <div class="opacity-row">
    <input type="range" name="opacity" min="0.05" max="1.0" step="0.05" value="{{ default_opacity }}" oninput="opVal.value=this.value">
    <output id="opVal">{{ default_opacity }}</output>
  </div>

  <h3>검색 옵션</h3>
  <div class="grid-2">
    <label><input type="checkbox" name="ignore_case" checked> 대소문자 무시</label>
    <label><input type="checkbox" name="whole_word"> 완전 단어 일치</label>
  </div>

  <div class="actions">
    <button type="submit">마크업 실행</button>
  </div>
</form>

<script>
  // 색 hex 표시 갱신
  document.querySelectorAll('.color-row input[type="color"]').forEach(inp=>{
    const span = inp.parentElement.querySelector('.hex');
    inp.addEventListener('input', ()=> span.textContent = inp.value.toUpperCase());
  });
</script>
{% endblock %}
