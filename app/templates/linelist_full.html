{% extends "layout.html" %}
{% block title %}라인리스트 - Full tag{% endblock %}
{% block content %}
<form class="card" id="upload-form" action="{{ url_for('main.annotate_full') }}" method="post" enctype="multipart/form-data">
  <h2>Full tag (FlashText 기반 고속 검색)</h2>
  <p class="muted">
    엑셀의 모든 컬럼 데이터를 자동으로 인식하고, 각 컬럼별로 자동 색상이 할당됩니다.<br>
    FlashText 알고리즘을 사용하여 빠른 검색이 가능합니다.
  </p>

  <div class="grid-2">
    <div>
      <label>엑셀 파일 (.xlsx / .xls)</label>
      <input type="file" name="excel_file" accept=".xlsx,.xls" required />
      <small class="muted">모든 컬럼의 데이터가 자동으로 검색됩니다.</small>
    </div>
    <div>
      <label>PDF 파일 (.pdf)</label>
      <input type="file" name="pdf_file" accept=".pdf" required />
    </div>
  </div>

  <h3>표시 옵션</h3>
  <div class="opacity-row">
    <label style="display:block;">불투명도</label>
    <input type="range" name="opacity" min="0.05" max="1.0" step="0.05" value="0.35" oninput="opVal.value=this.value">
    <output id="opVal">0.35</output>
  </div>

  <div class="actions">
    <button type="submit">마크업 실행</button>
    <a href="{{ url_for('main.linelist') }}" style="margin-left:8px;">← 라인리스트 메뉴</a>
  </div>
</form>

<div class="card" id="loading-state" style="display:none;">
  <h2>처리 중...</h2>
  <p>PDF 마크업 작업을 실행하고 있습니다. 파일 크기에 따라 몇 분 정도 소요될 수 있습니다.</p>
  <div class="actions">
    <a href="{{ url_for('main.linelist_full') }}" class="btn secondary">작업 취소 및 초기화</a>
  </div>
</div>

<script>
  // '마크업 실행' 버튼 클릭 시 UI 변경
  document.getElementById('upload-form').addEventListener('submit', function() {
    const excelFile = this.elements['excel_file'].files.length;
    const pdfFile = this.elements['pdf_file'].files.length;
    if (excelFile > 0 && pdfFile > 0) {
      document.getElementById('upload-form').style.display = 'none';
      document.getElementById('loading-state').style.display = 'block';
    }
  });
</script>
{% endblock %}